C  HARRAY.F - CREATE HYDROLOGY MODEL GRID-ELEMENT ARRAYS

C  ROUTINES IN THIS MODULE:

C  SUBROUTINE HARRAY (KERR)

C  CODE HISTORY:

C  JOHN WHEELER     4/29/97    ALPHA CODE
C  QIN LU           4/08/98    ALLOCATE BOUNDARY ELEMENT ARRAYS FOR MULTI-BLOCK
C  B MOMKEN        12/01/98    ADDED VISUALIZATION TIMER 12
C  JOHN WHEELER     6/18/99    ADDED CODE FOR MULTIMODEL
C*********************************************************************
      SUBROUTINE HARRAY (KERR)
C*********************************************************************

C  Creates hydrology model grid-element arrays

C  KERR = ERROR NUMBER (OUTPUT, INTEGER)

C  NOTE: See harydat.h for array descriptions

C*********************************************************************

$POWER        INCLUDE 'msjunk.h'
      INCLUDE 'control.h'
      INCLUDE 'blkary.h'

      INCLUDE 'harydat.h'

C  ALLOCATE GRID-ELEMENT ARRAY SPACE

      KERR=0

      CALL ALCGEA ('OILPRES ',2,0,N_POIL,KERR)
      IF (KERR.GT.0) GO TO 99
      CALL ALCGEA ('WATPRES ',2,0,N_PWAT,KERR)
      IF (KERR.GT.0) GO TO 99
      CALL ALCGEA ('OILCONC ',2,0,N_COIL,KERR)
      IF (KERR.GT.0) GO TO 99

      CALL TIMON(12)
      CALL ALCGEA ('VEL ',2,6,N_VEL,KERR)
      IF (KERR.GT.0) GO TO 99

      CALL ALCGEA ('DENSITY ',2,2,N_DDENS,KERR)
      IF (KERR.GT.0) GO TO 99
      CALL TIMOFF(12)

      CALL ALCGEA ('RELPERM ',2,4,N_RELPRM,KERR)
      IF (KERR.GT.0) GO TO 99

      CALL ALCGEA ('DPCSW ',2,0,N_DPCSW,KERR)
      IF (KERR.GT.0) GO TO 99
      CALL ALCGEA ('COILN ',2,0,N_COILN,KERR)
      IF (KERR.GT.0) GO TO 99
      CALL ALCGEA ('POILN ',2,0,N_POILN,KERR)
      IF (KERR.GT.0) GO TO 99
      CALL ALCGEA ('CWATN ',2,0,N_CWATN,KERR)
      IF (KERR.GT.0) GO TO 99

C  NOTE THAT THE FRAMEWORK ALSO NEEDS POINTERS TO THE NEXT 3 ARRAYS

      CALL ALCGEA ('DELUNK ',2,$HNUMEQ,N_DUNK,KERR)
      N_DUNKV(MODACT)=N_DUNK
      IF (KERR.GT.0) GO TO 99
      CALL ALCGEA ('COEFS ',1,$HNUMEQ*$HNUMEQ*$NUMCOF,N_COF,KERR)
      N_COFV(MODACT)=N_COF
      IF (KERR.GT.0) GO TO 99
      CALL ALCGEA ('RESIDS ',2,$HNUMEQ,N_RESID,KERR)
      N_RESIDV(MODACT)=N_RESID
      IF (KERR.GT.0) GO TO 99

C SGT - LOG|v| FOR SINTEF TESTS

      CALL ALCGEA ('VMO ',2,0,N_VMO,KERR)
      IF (KERR.GT.0) GO TO 99
      CALL ALCGEA ('VMW ',2,0,N_VMW,KERR)
      IF (KERR.GT.0) GO TO 99

   99 RETURN
      END
